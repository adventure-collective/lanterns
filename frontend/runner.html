<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Pixel Runner</title>
    <style media="screen">
      body {
        font-family: sans-serif;
        margin: 0;
      }
      form {
        display: flex;
        font-weight: 800;
        padding: .75em;
        border-bottom: 1px solid #ccc;
      }
      form label {
        flex: auto
      }
      form em {
        font-size: 0.5em;
        display: block;
      }

      body {
        display: flex;
        flex-direction: column;
        height: 100vh;
      }

      iframe {
        flex-grow: 1;
        border: none;
        background: #eee;
      }
    </style>
  </head>
  <body>
    <form>
      <label>
        script
        <select name="script">
          <option>--</option>
          <option value="index.html">demo 1</option>
        </select>
      </label>

      <label>
        layout
        <select name="layout">
          <option>--</option>
          <option value="hackspace-1.json">hackspace 1</option>
          <option value="ben.json">bens house</option>
        </select>
      </label>

      <label>
        development
        <input type="checkbox" checked name="development"/>
        <em>prevent broadcast to lights</em>
      </label>
    </form>

    <iframe src="about:blank" id="main"></iframe>

    <script type="text/javascript">
      const qsa = document.querySelectorAll.bind(document)
      const qs = document.querySelectorAll.bind(document)

      const storage = sessionStorage

      // persist values on load
      Array.from(qsa('select'))
        .forEach( input => {
          const store_key = `select-${input.name}`

          const initial = storage.getItem(store_key)
          if(initial !== null) input.value = initial

          input.addEventListener('change', () => {
            storage.setItem(store_key, input.value)
          }, false)
        })

      Array.from(qsa('[type=checkbox]'))
        .forEach( input => {
          const store_key = `checkbox-${input.name}`

          const initial = storage.getItem(store_key)
          if(initial !== null) input.checked = initial == 'true'

          input.addEventListener('change', () => {
            storage.setItem(store_key, input.checked)
          }, false)
        })


    </script>

  </body>
</html>
